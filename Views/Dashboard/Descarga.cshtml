@{
    ViewData["Title"] = "Dashboard - Diario";
    Layout = "_Layout";
}
<link rel="stylesheet" href="~/css/dashboard.css" />

@await Html.PartialAsync("_DashSwitcher")

<div class="dash-wrapper" style="font-family: 'Gilroy-Bold', sans-serif;">
    <!-- KPIs -->
    <aside class="kpi-panel">
        <div class="kpi">
            <div class="kpi-value" id="kpi-cant-azucar">0</div>
            <div class="kpi-label">Unidades descargadas por hora (Azúcar)</div>
        </div>
        <div class="kpi">
            <div class="kpi-value" id="kpi-cant-melaza">0</div>
            <div class="kpi-label">Unidades descargadas por hora (Melaza)</div>
        </div>

        <div class="kpi">
            <div class="kpi-value" id="kpi-transito-azucar">0 min 00 seg</div>
            <div class="kpi-label">Tiempo promedio a planta (Azúcar)</div>
        </div>
        <div class="kpi">
            <div class="kpi-value" id="kpi-transito-melaza">0 min 00 seg</div>
            <div class="kpi-label">Tiempo promedio a planta (Melaza)</div>
        </div>

        <div class="kpi">
            <div class="kpi-value" id="kpi-espera-plana">0 min 00 seg</div>
            <div class="kpi-label">Promedio de espera (Plana)</div>
        </div>
        <div class="kpi">
            <div class="kpi-value" id="kpi-espera-volteo">0 min 00 seg</div>
            <div class="kpi-label">Promedio de espera (Volteo)</div>
        </div>
        <div class="kpi">
            <div class="kpi-value" id="kpi-espera-pipa">0 min 00 seg</div>
            <div class="kpi-label">Promedio de espera (Pipa)</div>
        </div>

        <div class="kpi">
            <div class="kpi-value" id="kpi-descarga-plana">0 min 00 seg</div>
            <div class="kpi-label">Tiempo promedio de descarga (Plana)</div>
        </div>
        <div class="kpi">
            <div class="kpi-value" id="kpi-descarga-volteo">0 min 00 seg</div>
            <div class="kpi-label">Tiempo promedio de descarga (Volteo)</div>
        </div>
        <div class="kpi">
            <div class="kpi-value" id="kpi-descarga-pipa">0 min 00 seg</div>
            <div class="kpi-label">Tiempo promedio de descarga (Pipa)</div>
        </div>
    </aside>

    <!-- Filtros -->
    <main class="main-panel">
        <div class="filters">
            <div class="filter">
                <label>Hora</label>
                <div class="date-range time-range">
                    <input id="f-hour-start" type="time" step="3600" value="00:00" />
                    <span>–</span>
                    <input id="f-hour-end" type="time" step="3600" value="23:00" />
                </div>
            </div>

            <div class="filter">
                <label>Ingenio</label>
                <select id="f-ingenio">
                    <option value="">Todos</option>
                    <option value="JB">Ingenio Central Azucarero Jiboa</option>
                    <option value="ILC">Ingenio La Cabaña</option>
                    <option value="IEA">Ingenio El Angel</option>
                    <option value="ILM">Ingenio La Magdalena</option>
                    <option value="ICHP">Ingenio Chaparrastique</option>
                    <option value="CASSA">Compañía Azucarera Salvadoreña</option>
                </select>
            </div>

            <div class="filter">
                <label>Producto</label>
                <select id="f-producto">
                    <option value="" selected>Todos</option>
                    <option value="AZ-001">Azúcar</option>
                    <option value="MEL-001">Melaza</option>
                </select>
            </div>
        </div>

        <!-- Gráficos: uno por fila -->
        <!-- fuerza 1 columna -->
        <div class="charts-grid--single one-col" style="font-family:'Gilroy-Bold',sans-serif;">

            <section class="chart-card">
                <header>Tiempo tránsito planta<br></header>
                <div class="chart-scrollH">
                    <div class="chart-inner">
                        <canvas id="chart-transito-placa"></canvas>
                    </div>
                </div>
                <div class="legend"><span class="legend-title">Producto:</span> 
                <b class="dot dot-orange"></b> Azúcar 
                <b class="dot dot-blue"></b> Melaza</div>
            </section>

            <section class="chart-card">
                <header>Tiempo de espera<br></header>
                <div class="chart-scrollH">
                    <div class="chart-inner">
                        <canvas id="chart-espera-placa"></canvas>
                    </div>
                </div>
                <div class="legend"><span class="legend-title">Tipo Camión:</span> <b class="dot dot-orange"></b> Plana
                    <b class="dot dot-blue"></b> Volteo 
                    <b class="dot dot-black"></b> Pipa
                </div>
            </section>

            <section class="chart-card">
                <header>Tiempo de descarga<br></header>
                <div class="chart-scrollH">
                    <div class="chart-inner">
                        <canvas id="chart-descarga-placa"></canvas>
                    </div>
                </div>
                <div class="legend"><span class="legend-title">Tipo Camión:</span> <b class="dot dot-orange"></b> Plana
                    <b class="dot dot-blue"></b> Volteo <b class="dot dot-black"></b> Pipa</div>
            </section>

            

        </div>

    </main>
</div>
@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2"></script>
    <script>
        // Registrar el plugin de zoom/pan cuando se carga por CDN
        (function () {
            const zoomPlugin = window['chartjs-plugin-zoom'] || window.ChartZoom;
            if (zoomPlugin) Chart.register(zoomPlugin);
        })();
    </script>
    <script src="~/js/dash-core.js?v=20250828"></script>
    <script src="~/js/dash-placas.js?v=20250828"></script> <!-- cache-busting opcional -->
}
}